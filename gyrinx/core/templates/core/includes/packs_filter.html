{% load allauth custom_tags %}
{% comment %}Filter component for packs, used on the customisation page.
    Parameters:
    - action: The URL to submit the form to
{% endcomment %}
<form id="search"
      method="get"
      action="{{ action }}#search"
      class="grid g-col-12">
    <input type="hidden" name="flash" value="search">
    <input type="hidden" name="cb" value="{% cachebuster %}">
    {# Search row #}
    <div class="g-col-12 g-col-xl-6">
        <div class="hstack gap-2 align-items-end">
            <div class="input-group">
                <span class="input-group-text">
                    <i class="bi-search"></i>
                </span>
                <input class="form-control"
                       type="search"
                       placeholder="Search packs"
                       aria-label="Search packs"
                       name="q"
                       value="{{ request.GET.q }}">
                <button class="btn btn-primary" type="submit">Search</button>
            </div>
        </div>
    </div>
    <div class="g-col-12 align-items-center hstack gap-3 flex-wrap">
        {# Your Packs toggle #}
        <div class="form-check form-switch mb-0"
             {% if not user.is_authenticated %} data-bs-toggle="tooltip" data-bs-placement="top" title="Only available to signed-in users"{% endif %}>
            {# Hidden field to ensure 0 is sent when unchecked #}
            <input type="hidden" name="my" value="0">
            <input class="form-check-input"
                   type="checkbox"
                   role="switch"
                   id="my-packs"
                   name="my"
                   value="1"
                   data-gy-toggle-submit
                   {% if not user.is_authenticated %}disabled{% endif %}
                   {% if user.is_authenticated %}{% if request.GET.my == "1" or request.GET.my is None %}checked{% endif %}
                   {% endif %}>
            <label class="form-check-label fs-7 mb-0" for="my-packs">Your Packs Only</label>
        </div>
        <div class="btn-group align-items-center">
            <button class="btn btn-link icon-link btn-sm"
                    type="submit"
                    id="update-filters">
                <i class="bi-arrow-clockwise"></i>
                Update
            </button>
            â€¢
            <a class="btn btn-link text-secondary icon-link btn-sm"
               href="{{ action }}">Reset</a>
        </div>
    </div>
</form>
